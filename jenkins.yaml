---
  - name: Launch Jenkins
    hosts: CI
    
    vars:
      ghUser: lookup('env', 'GITHUB_USER')
      ghToken: lookup('env', 'GITHUB_TOKEN')
      acrAddress: lookup('env', 'ACR_ADDR')
      acrUsername: lookup('env', 'ACR_UID')
      acrPassword: lookup('env', 'ACR_PASS')


    tasks:
    - name: git clone
      git:
        repo: https://{{ ghUser }}:{{ ghToken }}@github.com/Nazar802/jenkinsimage.git
        dest: ~/auto
        

      #shell: |
      #  rm -rf auto
      #  "git clone https://{{ ghUser }}:{{ ghToken }}@github.com/Nazar802/jenkinsimage.git auto"
      #  cd auto
      #  cp /home/azureuser/secret/key.pem ~/auto/key.pem
      #  "docker login {{ acrAddress }} -u{{ acrUsername }} -p{{ acrPassword }}"
      #  "docker build . -t {{ acrAdderss }}/jenkins:latest"
      #  "docker push {{ acrAddress }}/jenkins:latest"
